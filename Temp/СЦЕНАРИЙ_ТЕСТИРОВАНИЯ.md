# Сценарий Тестирования Приложения "Журнал Рабочих Смен"

## Общая информация

**Приложение:** Журнал Рабочих Смен (ShiftLog)  
**Версия:** 1.0.0  
**Тип:** PWA (Progressive Web App)  
**Стек:** JavaScript (Vanilla), HTML5, CSS3, Supabase  
**Цель:** Учет рабочих смен и заработка для работников сферы обслуживания

## Тестовые среды

### Браузеры для тестирования
- ✅ Chrome (desktop/mobile)
- ✅ Firefox (desktop/mobile)
- ✅ Safari (desktop/mobile)
- ✅ Edge (desktop)

### Устройства
- ✅ Desktop (1920x1080, 1366x768)
- ✅ Tablet (768x1024)
- ✅ Mobile (375x667, 414x896, 360x640)

---

## 1. ТЕСТИРОВАНИЕ АУТЕНТИФИКАЦИИ

### 1.1 Регистрация нового пользователя

**Тест-кейс 1.1.1:** Успешная регистрация
```
1. Открыть приложение
2. Перейти на вкладку "Регистрация" 
3. Заполнить поля:
   - Email: test@example.com
   - Пароль: TestPassword123
   - Подтвердите пароль: TestPassword123
4. Нажать "Зарегистрироваться"

Ожидаемый результат:
- Отправлено письмо подтверждения
- Показано сообщение об отправке письма
- Форма очищена
```

**Тест-кейс 1.1.2:** Регистрация с невалидным email
```
1. Ввести email: "invalid-email"
2. Заполнить остальные поля корректно
3. Нажать "Зарегистрироваться"

Ожидаемый результат:
- Показана ошибка валидации email
- Регистрация не выполнена
```

**Тест-кейс 1.1.3:** Пароли не совпадают
```
1. Заполнить поля:
   - Email: test2@example.com
   - Пароль: Password123
   - Подтвердите пароль: Password124
2. Нажать "Зарегистрироваться"

Ожидаемый результат:
- Показана ошибка "Пароли не совпадают"
- Регистрация не выполнена
```

### 1.2 Вход в систему

**Тест-кейс 1.2.1:** Успешный вход
```
1. Перейти на вкладку "Вход"
2. Ввести существующие учетные данные
3. Нажать "Войти"

Ожидаемый результат:
- Успешная авторизация
- Переход к главному экрану приложения
- Навигация отображается корректно
```

**Тест-кейс 1.2.2:** Неверные учетные данные
```
1. Ввести неверный email или пароль
2. Нажать "Войти"

Ожидаемый результат:
- Показана ошибка авторизации
- Пользователь остается на экране входа
```

### 1.3 Восстановление пароля

**Тест-кейс 1.3.1:** Восстановление пароля
```
1. Нажать "Забыли пароль?"
2. Ввести зарегистрированный email
3. Подтвердить отправку

Ожидаемый результат:
- Письмо восстановления отправлено
- Показано уведомление пользователю
```

### 1.4 Выход из системы

**Тест-кейс 1.4.1:** Выход
```
1. В главном приложении перейти в "Настройки"
2. Нажать кнопку "Выход"

Ожидаемый результат:
- Пользователь разлогинен
- Переход к экрану авторизации
- Данные пользователя очищены из памяти
```

---

## 2. ТЕСТИРОВАНИЕ УПРАВЛЕНИЯ ЗАВЕДЕНИЯМИ

### 2.1 Добавление заведения

**Тест-кейс 2.1.1:** Успешное добавление
```
1. Перейти в "Настройки" → "Заведения"
2. Нажать "Добавить заведение"
3. Заполнить поля:
   - Название: "Ресторан Тест"  
   - Адрес: "ул. Тестовая, 1"
   - Телефон: "+7 (999) 123-45-67"
4. Нажать "Сохранить"

Ожидаемый результат:
- Заведение добавлено в список
- Модальное окно закрыто
- Заведение доступно в выборе смен
```

**Тест-кейс 2.1.2:** Добавление без обязательных полей
```
1. Открыть форму добавления заведения
2. Оставить поле "Название" пустым
3. Нажать "Сохранить"

Ожидаемый результат:
- Показана ошибка валидации
- Заведение не сохранено
- Форма остается открытой
```

### 2.2 Редактирование заведения

**Тест-кейс 2.2.1:** Успешное редактирование
```
1. В списке заведений нажать "Редактировать"
2. Изменить название на "Ресторан Тест (обновлено)"
3. Нажать "Сохранить"

Ожидаемый результат:
- Изменения сохранены
- Обновленное название отображается в списке
```

### 2.3 Удаление заведения

**Тест-кейс 2.3.1:** Удаление без связанных смен
```
1. Нажать "Удалить" для заведения
2. Подтвердить удаление

Ожидаемый результат:
- Заведение удалено из списка
- Данные удалены из базы
```

**Тест-кейс 2.3.2:** Удаление с существующими сменами
```
1. Попытаться удалить заведение, в котором есть смены
2. Подтвердить удаление

Ожидаемый результат:
- Показано предупреждение о связанных данных
- Возможность отменить или продолжить удаление
```

---

## 3. ТЕСТИРОВАНИЕ УПРАВЛЕНИЯ ПОЗИЦИЯМИ/УСЛУГАМИ

### 3.1 Добавление позиции

**Тест-кейс 3.1.1:** Добавление с фиксированной комиссией
```
1. Перейти в "Настройки" → "Позиции/Услуги"
2. Нажать "Добавить позицию"
3. Заполнить:
   - Название: "Кофе эспрессо"
   - Цена за единицу: 150
   - Тип комиссии: "Фиксированная сумма"
   - Размер комиссии: 25
4. Нажать "Сохранить"

Ожидаемый результат:
- Позиция добавлена в список
- Правильно отображается тип комиссии
```

**Тест-кейс 3.1.2:** Добавление с процентной комиссией
```
1. Добавить позицию:
   - Название: "Десерт"
   - Цена за единицу: 300
   - Тип комиссии: "Процент от продажи"
   - Размер комиссии: 15
2. Нажать "Сохранить"

Ожидаемый результат:
- Позиция сохранена с процентной комиссией
- В списке отображается "15%"
```

### 3.2 Валидация полей позиций

**Тест-кейс 3.2.1:** Отрицательные значения
```
1. Попытаться ввести отрицательную цену: -100
2. Нажать "Сохранить"

Ожидаемый результат:
- Показана ошибка валидации
- Позиция не сохранена
```

---

## 4. ТЕСТИРОВАНИЕ ЖУРНАЛА СМЕН

### 4.1 Добавление рабочей смены

**Тест-кейс 4.1.1:** Полная рабочая смена
```
1. Перейти в "Журнал"
2. Нажать кнопку "+" (добавить смену)
3. Заполнить форму:
   - Дата: текущая дата
   - Тип дня: "Рабочий день"
   - Заведение: выбрать из списка
   - Фиксированный выход: 1000
   - Чай: 500
   - Позиции: добавить 2-3 позиции с количеством
4. Нажать "Сохранить"

Ожидаемый результат:
- Смена добавлена в журнал
- Автоматически рассчитаны итоги
- Отображается в списке смен
```

**Тест-кейс 4.1.2:** Добавление выходного дня
```
1. Открыть форму смены
2. Выбрать "Выходной"
3. Указать только дату
4. Нажать "Сохранить"

Ожидаемый результат:
- Смена сохранена как выходной
- Все суммы равны 0
- В таблице отображается как "Выходной"
```

### 4.2 Автоматические расчеты

**Тест-кейс 4.2.1:** Расчет выручки
```
1. Добавить смену с позициями:
   - Кофе (150₽ x 10 шт) = 1500₽
   - Десерт (300₽ x 5 шт) = 1500₽
2. Проверить итоговую выручку

Ожидаемый результат:
- Выручка = 3000₽
- Расчет отображается в реальном времени
```

**Тест-кейс 4.2.2:** Расчет заработка с комиссией
```
1. Для тех же позиций (фикс. комиссия 25₽ + 15%):
   - Кофе: 10 x 25₽ = 250₽
   - Десерт: 5 x (300₽ x 15%) = 225₽
2. + Фиксированный выход: 1000₽
3. + Чай: 500₽

Ожидаемый результат:
- Заработок = 1975₽ (250 + 225 + 1000 + 500)
```

### 4.3 Редактирование смены

**Тест-кейс 4.3.1:** Редактирование существующей смены
```
1. Нажать на смену в журнале
2. Изменить количество позиций
3. Сохранить изменения

Ожидаемый результат:
- Изменения сохранены
- Пересчитаны итоги
- Обновлена таблица смен
```

### 4.4 Удаление смены

**Тест-кейс 4.4.1:** Удаление смены
```
1. Открыть смену для редактирования
2. Нажать "Удалить смену"
3. Подтвердить удаление

Ожидаемый результат:
- Смена удалена из журнала
- Обновлены месячные итоги
```

### 4.5 Навигация по месяцам

**Тест-кейс 4.5.1:** Переключение месяцев
```
1. Нажать стрелку "←" для предыдущего месяца
2. Нажать стрелку "→" для следующего месяца

Ожидаемый результат:
- Заголовок месяца обновляется
- Загружаются смены соответствующего месяца
- Пустые месяцы показывают "Нет смен"
```

---

## 5. ТЕСТИРОВАНИЕ ОТЧЕТОВ

### 5.1 Просмотр итогов месяца

**Тест-кейс 5.1.1:** Расчет месячной статистики
```
1. Перейти в "Итоги"
2. Проверить отображение:
   - Общая выручка
   - Общий выход
   - Общий чай
   - Заработок (гросс)

Ожидаемый результат:
- Все суммы рассчитаны корректно
- Отображаются в выбранной валюте
```

**Тест-кейс 5.1.2:** Добавление премии
```
1. В поле "Премия" ввести: 5000
2. Проверить расчет чистого заработка

Ожидаемый результат:
- Чистый заработок = Гросс заработок + Премия
- Значение обновляется автоматически
```

**Тест-кейс 5.1.3:** Статистика продаж
```
1. Проверить секцию "Продажи"
2. Убедиться в корректности:
   - Количество позиций
   - Общая сумма по каждой позиции

Ожидаемый результат:
- Статистика соответствует данным смен
- Позиции отсортированы по убыванию суммы
```

### 5.2 Экспорт данных

**Тест-кейс 5.2.1:** Экспорт месячных данных
```
1. Нажать "Экспорт данных"
2. Проверить содержимое файла

Ожидаемый результат:
- Файл загружается в формате JSON
- Содержит все данные за месяц
- Структура соответствует схеме БД
```

---

## 6. ТЕСТИРОВАНИЕ ИНТЕРФЕЙСА

### 6.1 Адаптивность

**Тест-кейс 6.1.1:** Мобильная версия (375px)
```
1. Открыть приложение на мобильном устройстве
2. Проверить все экраны:
   - Авторизация
   - Журнал смен
   - Итоги
   - Настройки

Ожидаемый результат:
- Все элементы помещаются на экране
- Текст читабелен
- Кнопки достаточно большие для касания (44px+)
- Модальные окна открываются на весь экран
```

**Тест-кейс 6.1.2:** Планшетная версия (768px)
```
1. Проверить отображение на планшете
2. Убедиться в корректной работе всех функций

Ожидаемый результат:
- Оптимальное использование пространства
- Таблицы не переполняются
- Навигация работает корректно
```

### 6.2 Модальные окна

**Тест-кейс 6.2.1:** Открытие/закрытие модальных окон
```
1. Открыть каждое модальное окно:
   - Добавление смены
   - Добавление заведения
   - Добавление позиции
2. Закрыть через крестик и клик вне окна

Ожидаемый результат:
- Окна открываются с анимацией
- Фон затемняется
- Корректно закрываются всеми способами
- Данные форм сбрасываются при закрытии
```

### 6.3 Уведомления

**Тест-кейс 6.3.1:** Системные сообщения
```
1. Выполнить действия, вызывающие уведомления:
   - Успешное сохранение
   - Ошибки валидации
   - Ошибки сети

Ожидаемый результат:
- Уведомления отображаются в верхней части экрана
- Автоматически исчезают через несколько секунд
- Текст понятен пользователю
```

---

## 7. PWA ФУНКЦИОНАЛЬНОСТЬ

### 7.1 Установка приложения

**Тест-кейс 7.1.1:** Установка на мобильное устройство
```
1. Открыть приложение в Chrome на Android
2. Дождаться появления баннера установки
3. Нажать "Установить"

Ожидаемый результат:
- Приложение установлено на домашний экран
- Иконка отображается корректно
- Запуск происходит в полноэкранном режиме
```

**Тест-кейс 7.1.2:** Установка на desktop
```
1. Открыть в Chrome на десктопе
2. Нажать иконку установки в адресной строке
3. Подтвердить установку

Ожидаемый результат:
- Приложение установлено как десктопное
- Создан ярлык в меню
- Работает как отдельное окно
```

### 7.2 Offline функциональность

**Тест-кейс 7.2.1:** Работа без интернета
```
1. Открыть приложение онлайн
2. Отключить интернет
3. Попытаться:
   - Просмотреть кэшированные данные
   - Перейти между экранами
   - Обновить страницу

Ожидаемый результат:
- Базовый интерфейс загружается из кэша
- Переходы между экранами работают
- Показывается индикатор offline режима
```

**Тест-кейс 7.2.2:** Синхронизация при подключении
```
1. В offline режиме попытаться сохранить данные
2. Включить интернет
3. Проверить синхронизацию

Ожидаемый результат:
- Показано уведомление о недоступности сети
- При подключении данные актуализируются
```

### 7.3 Service Worker

**Тест-кейс 7.3.1:** Кэширование ресурсов
```
1. Открыть DevTools → Application → Storage
2. Проверить кэш приложения
3. Обновить версию и проверить очистку старого кэша

Ожидаемый результат:
- Статические файлы кэшируются корректно
- Старые версии кэша удаляются при обновлении
- Supabase запросы не кэшируются
```

---

## 8. ТЕСТИРОВАНИЕ БЕЗОПАСНОСТИ

### 8.1 Row Level Security (RLS)

**Тест-кейс 8.1.1:** Изоляция данных пользователей
```
1. Создать два аккаунта пользователей
2. Добавить данные от каждого пользователя
3. Проверить доступность данных

Ожидаемый результат:
- Каждый пользователь видит только свои данные
- Нет доступа к данным других пользователей
- RLS политики работают на уровне БД
```

### 8.2 Валидация входных данных

**Тест-кейс 8.2.1:** XSS защита
```
1. Попытаться ввести JavaScript код в текстовые поля:
   - <script>alert('xss')</script>
   - javascript:alert('xss')
2. Сохранить и проверить отображение

Ожидаемый результат:
- Скрипты не выполняются
- Данные экранируются при отображении
```

### 8.3 Аутентификация

**Тест-кейс 8.3.1:** Сессии и токены
```
1. Авторизоваться в приложении
2. Проверить токены в localStorage/sessionStorage
3. Попытаться получить доступ к API с невалидным токеном

Ожидаемый результат:
- Токены сохранены безопасно
- Истекшие токены обновляются автоматически
- Неавторизованные запросы отклоняются
```

---

## 9. ТЕСТИРОВАНИЕ ПРОИЗВОДИТЕЛЬНОСТИ

### 9.1 Загрузка приложения

**Тест-кейс 9.1.1:** Время первой загрузки
```
1. Очистить кэш браузера
2. Открыть приложение
3. Измерить время загрузки до готовности

Ожидаемый результат:
- Время загрузки < 3 секунд на 3G
- Показывается индикатор загрузки
- Progressive loading (сначала shell, потом данные)
```

### 9.2 Работа с большими объемами данных

**Тест-кейс 9.2.1:** Множество смен
```
1. Создать 100+ смен за месяц
2. Проверить производительность:
   - Загрузка списка смен
   - Переключение между месяцами
   - Расчет итогов

Ожидаемый результат:
- Интерфейс остается отзывчивым
- Нет заметных задержек при переключении
- Память не переполняется
```

### 9.3 Сетевые запросы

**Тест-кейс 9.3.1:** Оптимизация запросов
```
1. Открыть DevTools → Network
2. Выполнить типичные операции пользователя
3. Проанализировать запросы

Ожидаемый результат:
- Минимальное количество запросов
- Нет дублирующихся запросов
- Используется кэширование где возможно
```

---

## 10. КРИТИЧЕСКИЕ СЦЕНАРИИ

### 10.1 Потеря данных

**Тест-кейс 10.1.1:** Прерывание во время сохранения
```
1. Начать заполнение формы смены
2. В процессе сохранения закрыть браузер/отключить интернет
3. Открыть приложение снова

Ожидаемый результат:
- Частично введенные данные не повреждают БД
- Показано корректное сообщение об ошибке
- Возможность повторить операцию
```

### 10.2 Конкурентное редактирование

**Тест-кейс 10.2.1:** Одновременное редактирование
```
1. Открыть приложение в двух вкладках/устройствах
2. Одновременно редактировать одну смену
3. Сохранить изменения

Ожидаемый результат:
- Последние изменения сохраняются
- Нет потери данных или конфликтов
- Показано предупреждение о конфликте
```

---

## 11. ЧЕКЛИСТ ПЕРЕД РЕЛИЗОМ

### 11.1 Основные функции
- [ ] Регистрация и авторизация работают
- [ ] Все CRUD операции выполняются корректно
- [ ] Расчеты производятся точно
- [ ] Навигация между экранами работает
- [ ] Модальные окна открываются/закрываются

### 11.2 UI/UX
- [ ] Адаптивный дизайн на всех устройствах
- [ ] Все тексты на русском языке
- [ ] Кнопки достаточно большие для касания
- [ ] Цветовая схема соответствует дизайну
- [ ] Анимации работают плавно

### 11.3 PWA
- [ ] Манифест корректен
- [ ] Service Worker кэширует нужные файлы
- [ ] Приложение устанавливается на устройства
- [ ] Offline функциональность работает
- [ ] Иконки отображаются корректно

### 11.4 Безопасность
- [ ] RLS политики настроены
- [ ] Входные данные валидируются
- [ ] Нет XSS уязвимостей
- [ ] Токены хранятся безопасно

### 11.5 Производительность
- [ ] Быстрая загрузка приложения
- [ ] Нет memory leaks
- [ ] Оптимизированные запросы к БД
- [ ] Работа с большими объемами данных

### 11.6 Кроссбраузерность
- [ ] Chrome (Android/Desktop)
- [ ] Firefox (Android/Desktop) 
- [ ] Safari (iOS/macOS)
- [ ] Edge (Desktop)

---

## 12. ОТЧЕТНОСТЬ ПО БАГАМ

### Приоритеты багов
- **Критический:** Потеря данных, невозможность входа
- **Высокий:** Неработающие основные функции
- **Средний:** UI/UX проблемы, совместимость
- **Низкий:** Косметические проблемы

### Формат отчета о баге
```
ID: BUG-001
Заголовок: Краткое описание
Приоритет: Критический/Высокий/Средний/Низкий
Среда: Браузер, ОС, устройство
Шаги воспроизведения:
1. ...
2. ...
Ожидаемый результат: ...
Фактический результат: ...
Дополнительно: скриншоты, логи
```

---

## 13. АВТОМАТИЗАЦИЯ ТЕСТИРОВАНИЯ

### Рекомендуемые инструменты
- **E2E тестирование:** Playwright/Cypress
- **Unit тесты:** Jest
- **Accessibility:** axe-core
- **Performance:** Lighthouse CI
- **Cross-browser:** BrowserStack

### Приоритет автоматизации
1. **Критические пути:** авторизация, создание смены
2. **Регрессионные тесты:** основные CRUD операции  
3. **Интеграционные тесты:** взаимодействие с Supabase
4. **Performance тесты:** загрузка и отзывчивость

---

**Документ подготовлен:** [Дата]  
**Версия:** 1.0  
**Ответственный за тестирование:** [Имя]  
**Статус:** Готов к использованию
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ñ—É—Ä–Ω–∞–ª –†–∞–±–æ—á–∏—Ö –°–º–µ–Ω</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <meta name="description" content="–£—á–µ—Ç —Ä–∞–±–æ—á–∏—Ö —Å–º–µ–Ω –∏ –∑–∞—Ä–∞–±–æ—Ç–∫–∞">
</head>
<body>
    <div id="app">
        <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div id="loading-screen" class="loading-screen">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
        <div id="auth-screen" class="screen hidden">
            <div class="auth-container">
                <h1>–ñ—É—Ä–Ω–∞–ª –†–∞–±–æ—á–∏—Ö –°–º–µ–Ω</h1>
                <div class="auth-tabs">
                    <button class="tab-btn active" data-tab="login">–í—Ö–æ–¥</button>
                    <button class="tab-btn" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                
                <form id="auth-form" class="auth-form">
                    <div class="form-group">
                        <input type="email" id="email" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                    </div>
                    <div class="form-group hidden" id="confirm-password-group">
                        <input type="password" id="confirm-password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                    </div>
                    <button type="submit" class="btn btn-primary">–í–æ–π—Ç–∏</button>
                </form>
                
                <button id="forgot-password-btn" class="btn btn-link">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</button>
            </div>
        </div>

        <!-- –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
        <div id="main-app" class="screen hidden">
            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
            <nav class="nav-bar">
                <button class="nav-btn active" data-screen="shifts">–ñ—É—Ä–Ω–∞–ª</button>
                <button class="nav-btn" data-screen="reports">–ò—Ç–æ–≥–∏</button>
                <button class="nav-btn" data-screen="settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </nav>

            <!-- –≠–∫—Ä–∞–Ω –∂—É—Ä–Ω–∞–ª–∞ —Å–º–µ–Ω -->
            <div id="shifts-screen" class="content-screen">
                <div class="screen-header">
                    <h2>–ñ—É—Ä–Ω–∞–ª —Å–º–µ–Ω</h2>
                    <div class="month-navigation">
                        <button class="btn btn-icon" id="prev-month">‚Üê</button>
                        <span id="current-month">–Ø–Ω–≤–∞—Ä—å 2024</span>
                        <button class="btn btn-icon" id="next-month">‚Üí</button>
                    </div>
                </div>
                
                <div class="shifts-table">
                    <div class="table-header">
                        <div class="table-cell">–î–∞—Ç–∞</div>
                        <div class="table-cell">–ó–∞–≤–µ–¥–µ–Ω–∏–µ</div>
                        <div class="table-cell">–í—ã—Ä—É—á–∫–∞</div>
                        <div class="table-cell">–ó–∞—Ä–∞–±–æ—Ç–æ–∫</div>
                    </div>
                    <div id="shifts-list" class="table-body">
                        <!-- –°–º–µ–Ω—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <button class="fab" id="add-shift-btn">+</button>
            </div>

            <!-- –≠–∫—Ä–∞–Ω –∏—Ç–æ–≥–æ–≤ -->
            <div id="reports-screen" class="content-screen hidden">
                <div class="screen-header">
                    <h2>–ò—Ç–æ–≥–∏</h2>
                    <div class="month-navigation">
                        <button class="btn btn-icon" id="reports-prev-month">‚Üê</button>
                        <span id="reports-current-month">–Ø–Ω–≤–∞—Ä—å 2024</span>
                        <button class="btn btn-icon" id="reports-next-month">‚Üí</button>
                    </div>
                </div>
                
                <div class="reports-content">
                    <div class="report-section">
                        <h3>–ü—Ä–æ–¥–∞–∂–∏</h3>
                        <div id="sales-stats" class="stats-grid">
                            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂ -->
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <h3>–§–∏–Ω–∞–Ω—Å—ã</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-label">–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞:</span>
                                <span class="stat-value" id="total-revenue">0 ‚ÇΩ</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">–û–±—â–∏–π –≤—ã—Ö–æ–¥:</span>
                                <span class="stat-value" id="total-payout">0 ‚ÇΩ</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">–û–±—â–∏–π —á–∞–π:</span>
                                <span class="stat-value" id="total-tips">0 ‚ÇΩ</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ (–≥—Ä–æ—Å—Å):</span>
                                <span class="stat-value" id="gross-earnings">0 ‚ÇΩ</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–ü—Ä–µ–º–∏—è:</label>
                            <input type="number" id="bonus-input" placeholder="0" min="0">
                        </div>
                        
                        <div class="stat-item total">
                            <span class="stat-label">–ß–∏—Å—Ç—ã–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫:</span>
                            <span class="stat-value" id="net-earnings">0 ‚ÇΩ</span>
                        </div>
                        
                        <div class="form-group">
                            <label>–î–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∏—è:</label>
                            <input type="date" id="payment-date">
                        </div>
                    </div>
                    
                    <button class="btn btn-secondary" id="export-btn">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                </div>
            </div>

            <!-- –≠–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
            <div id="settings-screen" class="content-screen hidden">
                <div class="screen-header">
                    <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                </div>
                
                <div class="settings-content">
                    <div class="settings-section">
                        <h3>–ó–∞–≤–µ–¥–µ–Ω–∏—è</h3>
                        <div id="venues-list" class="list-items">
                            <!-- –°–ø–∏—Å–æ–∫ –∑–∞–≤–µ–¥–µ–Ω–∏–π -->
                        </div>
                        <button class="btn btn-secondary" id="add-venue-btn">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–µ–¥–µ–Ω–∏–µ</button>
                    </div>
                    
                    <div class="settings-section">
                        <h3>–ü–æ–∑–∏—Ü–∏–∏/–£—Å–ª—É–≥–∏</h3>
                        <div id="products-list" class="list-items">
                            <!-- –°–ø–∏—Å–æ–∫ –ø–æ–∑–∏—Ü–∏–π -->
                        </div>
                        <button class="btn btn-secondary" id="add-product-btn">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é</button>
                    </div>
                    
                    <div class="settings-section">
                        <h3>–í–∞–ª—é—Ç–∞</h3>
                        <div class="form-group">
                            <select id="currency-select">
                                <option value="‚ÇΩ">‚ÇΩ (–†—É–±–ª—å)</option>
                                <option value="$">$ (–î–æ–ª–ª–∞—Ä)</option>
                                <option value="‚Ç¨">‚Ç¨ (–ï–≤—Ä–æ)</option>
                                <option value="p.">p. (–†—É–±–ª—å)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3>üîß –û—Ç–ª–∞–¥–∫–∞</h3>
                        <button class="btn btn-secondary" id="debug-user-btn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                        <div id="debug-info" style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px; font-family: monospace; font-size: 12px; display: none;"></div>
                    </div>
                    
                    <button class="btn btn-danger" id="logout-btn">–í—ã—Ö–æ–¥</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="shift-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="shift-modal-title">–î–æ–±–∞–≤–∏—Ç—å —Å–º–µ–Ω—É</h3>
                <button class="btn btn-icon" id="close-shift-modal">√ó</button>
            </div>
            <form id="shift-form" class="modal-body">
                <div class="form-group">
                    <label>–î–∞—Ç–∞:</label>
                    <input type="date" id="shift-date" required>
                </div>
                
                <div class="form-group">
                    <label>–°—Ç–∞—Ç—É—Å –¥–Ω—è:</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="workday" value="true" checked>
                            –†–∞–±–æ—á–∏–π –¥–µ–Ω—å
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="workday" value="false">
                            –í—ã—Ö–æ–¥–Ω–æ–π
                        </label>
                    </div>
                </div>
                
                <div id="work-fields">
                    <div class="form-group">
                        <label>–ó–∞–≤–µ–¥–µ–Ω–∏–µ:</label>
                        <select id="shift-venue" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ</option>
                        </select>
                    </div>
                    
                    <div id="products-fields">
                        <!-- –ü–æ–ª—è –¥–ª—è –ø–æ–∑–∏—Ü–∏–π –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    
                    <div class="form-group">
                        <label>–í—ã—Ö–æ–¥ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞):</label>
                        <input type="number" id="shift-payout" min="0" step="0.01">
                    </div>
                    
                    <div class="form-group">
                        <label>–ß–∞–µ–≤—ã–µ:</label>
                        <input type="number" id="shift-tips" min="0" step="0.01">
                    </div>
                    
                    <div class="form-group readonly">
                        <label>–í—ã—Ä—É—á–∫–∞:</label>
                        <input type="text" id="shift-revenue" readonly>
                    </div>
                    
                    <div class="form-group readonly">
                        <label>–ó–∞—Ä–∞–±–æ—Ç–æ–∫:</label>
                        <input type="text" id="shift-earnings" readonly>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancel-shift">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-danger hidden" id="delete-shift">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="venue-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="venue-modal-title">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–µ–¥–µ–Ω–∏–µ</h3>
                <button class="btn btn-icon" id="close-venue-modal">√ó</button>
            </div>
            <form id="venue-form" class="modal-body">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è:</label>
                    <input type="text" id="venue-name" required>
                </div>
                
                <div class="form-group">
                    <label>–°—Ç–∞–≤–∫–∞ –∑–∞ –≤—ã—Ö–æ–¥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:</label>
                    <input type="number" id="venue-payout" min="0" step="0.01">
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancel-venue">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-danger hidden" id="delete-venue">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="product-modal-title">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é</h3>
                <button class="btn btn-icon" id="close-product-modal">√ó</button>
            </div>
            <form id="product-form" class="modal-body">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏/—É—Å–ª—É–≥–∏:</label>
                    <input type="text" id="product-name" required>
                </div>
                
                <div class="form-group">
                    <label>–¶–µ–Ω–∞ –∑–∞–≤–µ–¥–µ–Ω–∏—è –∑–∞ –µ–¥–∏–Ω–∏—Ü—É:</label>
                    <input type="number" id="product-price" min="0" step="0.01" required>
                </div>
                
                <div class="form-group">
                    <label>–ú–µ—Ç–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ –∫–æ–º–∏—Å—Å–∏–∏:</label>
                    <select id="commission-type" required>
                        <option value="fixed">–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É</option>
                        <option value="percentage">–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Ü–µ–Ω—ã –∑–∞–≤–µ–¥–µ–Ω–∏—è</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label id="commission-label">–ó–Ω–∞—á–µ–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–∏:</label>
                    <input type="number" id="commission-value" min="0" step="0.01" required>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancel-product">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-danger hidden" id="delete-product">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="message-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="message-title">–°–æ–æ–±—â–µ–Ω–∏–µ</h3>
                <button class="btn btn-icon" id="close-message-modal">√ó</button>
            </div>
            <div class="modal-body">
                <p id="message-text"></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="close-message">OK</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="app.js"></script>
    
    <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker –¥–ª—è PWA -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registered: ', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }
    </script>
</body>
</html> 